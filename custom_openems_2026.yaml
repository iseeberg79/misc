power:
  source: http
  uri: http://YOUR_HOST/rest/channel/_sum/EssDischargePower
  auth:
    type: basic
    user: x
    password: YOUR_PASSWORD
  jq: (.value // 0)
soc:
  source: http
  uri: http://YOUR_HOST/rest/channel/_sum/EssSoc
  auth:
    type: basic
    user: x
    password: YOUR_PASSWORD
  jq: (.value // 0)
batterymode:
  source: watchdog
  timeout: 60s # re-write at timeout/2
  reset: 1
  set:
    source: switch
    switch:
    - case: 1 # normal
      set:
        source: http
        uri: http://YOUR_HOST/rest/channel/YOUR_ESS_DEVICE/SetActivePowerEquals
        auth:
          type: basic
          user: x
          password: YOUR_PASSWORD
        method: POST
        headers:
        - content-type: application/json
        body: '{"value": 0}'
    - case: 2 # hold
      set:
        source: http
        uri: http://YOUR_HOST/rest/channel/YOUR_ESS_DEVICE/SetActivePowerEquals
        auth:
          type: basic
          user: x
          password: YOUR_PASSWORD
        method: POST
        headers:
        - content-type: application/json
        body: '{"value": 0}'
    - case: 3 # charge
      set:
        source: http
        uri: http://YOUR_HOST/rest/channel/YOUR_ESS_DEVICE/SetActivePowerEquals
        auth:
          type: basic
          user: x
          password: YOUR_PASSWORD
        method: POST
        headers:
        - content-type: application/json
        body: '{"value": -4200}' # Ihre maxchargepower, negativ f√ºr Laden (hier: -4200)
capacity: YOUR_CAPACITY # kWh
maxdischargepower: YOUR_DISCHARGE_POWER # kWh
maxchargepower: YOUR_CHARGE_POWER # kWh
